/*
    webamp.css
    WebAmp app page styling
*/

/* Base page styles (self-contained: app pages can run without host CSS) */
*,
*::before,
*::after {
    box-sizing: border-box;
}

html,
body {
    margin: 0;
    padding: 0;
    width: 100%;
    min-height: 100%;
    background: #0e0e12;
    color: rgba(255, 255, 255, 0.92);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}

body {
    overflow-x: hidden;
    overflow-y: auto;
}

button,
input {
    font: inherit;
    color: inherit;
}

a {
    color: inherit;
    text-decoration: none;
}

/* App-level tokens */
:root {
    --wa-border: rgba(255, 255, 255, 0.16);
    --wa-border-strong: rgba(255, 255, 255, 0.26);
    --wa-text-dim: rgba(255, 255, 255, 0.74);
    --wa-shadow: 0 18px 60px rgba(0, 0, 0, 0.55);
    --wa-radius-lg: 16px;
    --wa-radius-md: 14px;
    --wa-playerbar-height: 48px; /* was 74px */
}

/* Loading splash (uses shared host markup: .loading-overlay) */
.loading-overlay {
    position: fixed;
    inset: 0;
    z-index: 10000;
    background: #0e0e12;
    display: block;
    opacity: 1;
    transition: opacity 0.2s ease, filter 0.2s ease, transform 0.2s ease;
}

.loading-overlay img {
    width: 80px;
    height: auto;
    filter: invert(1);
}

.loading-overlay .loading-logo {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.loading-overlay img.loading-throbber {
    position: absolute;
    top: calc(55% + 64px);
    left: 50%;
    transform: translate(-50%, -50%);
    width: 28px;
}

body[data-initial-state="ready"] .loading-overlay {
    opacity: 0;
    pointer-events: none;
    transform: scale(1.05);
    filter: blur(18px);
}

/* Glass surface (WebAmp version): keep it CLEAR with no tinted/gradient overlay. */
.glass-surface {
    border-radius: var(--wa-radius-lg);
    /* border: 1px solid var(--wa-border); */
    background: transparent;
    box-shadow: var(--wa-shadow);
    position: relative;
    overflow: hidden;
}

@supports ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
    /*
        IMPORTANT:
        Do NOT apply backdrop-filter to .glass-surface directly; it can cause position:fixed children
        (like the player bar) to become fixed-to-this-element instead of the viewport in some browsers.
        Apply blur on a non-ancestor layer instead.
    */
    .glass-surface::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        pointer-events: none;
        backdrop-filter: blur(10px) saturate(1.25);
        -webkit-backdrop-filter: blur(10px) saturate(1.25);
        z-index: 0;
    }
}

.glass-surface__content {
    width: 100%;
    height: 100%;
    padding: 1.1rem 1.1rem;
    border-radius: inherit;
    position: relative;
    z-index: 1;
}

/* App layout (scoped under .wa-app) */
.wa-app {
    min-height: 100vh;
    /* padding: 1.25rem 1.1rem; */
    /* Keep the outer container edge-to-edge; reserve player-bar space inside scrollable content instead. */
    padding-bottom: 0;
    /* max-width: 1280px; */
    margin: 0 auto;
    width: 100%;
}

.wa-shell {
    min-height: 100vh;
}

.wa-shell__content {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

/* Layout: desktop has a pinned sidebar; mobile uses a slide-over sidebar */
.wa-layout {
    display: grid;
    grid-template-columns: 260px minmax(0, 1fr);
    gap: 0.9rem;
    min-height: calc(100vh - var(--wa-playerbar-height) - env(safe-area-inset-bottom, 0px));
}

.wa-content {
    min-width: 0;
}

/* Brand + icon buttons */
.wa-brand {
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.4rem 0.55rem;
    border-radius: 999px;
    /* border: 1px solid rgba(255, 255, 255, 0.14); */
}

.wa-brand:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.9);
    outline-offset: 2px;
}

.wa-brand--sidebar {
    border-color: rgba(255, 255, 255, 0.12);
}

.wa-brand__mark {
    width: 28px;
    height: 28px;
    border-radius: 10px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255, 255, 255, 0.18);
    font-size: 0.8rem;
    letter-spacing: 0.08em;
}

.wa-brand__text {
    font-weight: 600;
    letter-spacing: 0.03em;
}

.wa-iconbtn {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.14);
    background: transparent;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

.wa-iconbtn:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.9);
    outline-offset: 2px;
}

/* Sidebar */
.wa-sidebar {
    border-radius: var(--wa-radius-lg);
    border: 1px solid rgba(255, 255, 255, 0.12);
    /* Needs some alpha for backdrop-filter to be visible */
    background: rgba(0, 0, 0, 0.28);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.35);
    overflow: hidden;
    position: relative;
    height: auto;
}

@supports ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
    .wa-sidebar {
        backdrop-filter: blur(14px) saturate(1.2) brightness(0.92);
        -webkit-backdrop-filter: blur(14px) saturate(1.2) brightness(0.92);
    }
}

.wa-sidebar__inner {
    padding: 0.9rem;
    display: flex;
    flex-direction: column;
    gap: 0.9rem;
    min-height: 100%;
    height: 100%;
}

.wa-sidebar__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.6rem;
}

.wa-sidebar__close {
    display: none;
}

.wa-sidenav {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.wa-sidenav__link {
    padding: 0.6rem 0.7rem;
    border-radius: 12px;
    border: 1px solid transparent;
    color: rgba(255, 255, 255, 0.82);
}

.wa-sidenav__link:hover {
    border-color: rgba(255, 255, 255, 0.14);
}

.wa-sidenav__link[data-wa-active="true"] {
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.96);
    backdrop-filter: invert(0.45);
}

.wa-sidebar__footer {
    margin-top: auto;
    padding-top: 0.4rem;
    border-top: 1px solid rgba(255, 255, 255, 0.10);
}

.wa-sidebar__status {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.68);
}

/* Top bar (mobile burger lives here; desktop keeps it subtle) */
.wa-topbar {
    display: flex;
    align-items: center;
    gap: 0.65rem;
    padding: 0.2rem 0.15rem 0.4rem 0.15rem;
}

.wa-topbar__burger {
    display: none;
}

.wa-topbar__title {
    font-weight: 600;
    letter-spacing: 0.02em;
    color: rgba(255, 255, 255, 0.9);
}

/* Main view host */
.wa-main {
    padding: 0.2rem 0.1rem 0.75rem 0.1rem;
    padding-bottom: calc(var(--wa-playerbar-height) + env(safe-area-inset-bottom, 0px) + 1rem);
}

/* Desktop app-shell behavior: only the content column scrolls. Sidebar stays pinned and stops above player bar. */
@media (min-width: 821px) {
    body {
        overflow: hidden;
    }

    .wa-shell {
        height: 100vh;
    }

    .wa-shell__content {
        height: 100%;
    }

    /* Reserve space for the fixed player bar by shrinking the app layout. */
    .wa-layout {
        height: calc(100% - var(--wa-playerbar-height) - env(safe-area-inset-bottom, 0px));
        min-height: 0;
    }

    .wa-content {
        height: 100%;
        min-height: 0;
        overflow-y: auto;
        overscroll-behavior: contain;
    }

    /* We already reserved space for the player bar via .wa-layout height. */
    .wa-main {
        padding-bottom: 1rem;
    }

    .wa-sidebar {
        height: 100%;
        max-height: 100%;
        overflow: hidden;
    }

    /* Let nav scroll if needed, while keeping footer pinned at bottom. */
    .wa-sidenav {
        flex: 1;
        overflow: auto;
        min-height: 0;
    }
}

.wa-view-host {
    min-height: 320px;
}

.wa-sidebar-overlay {
    display: none;
}

/* Typography + cards (UI kit scaffolding) */
.wa-h1 {
    margin: 0 0 0.4rem 0;
    font-size: clamp(1.4rem, 3vw, 2rem);
    letter-spacing: 0.02em;
}

.wa-h2 {
    margin: 0 0 0.45rem 0;
    font-size: 1.05rem;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: rgba(255, 255, 255, 0.86);
}

.wa-h3 {
    margin: 0 0 0.35rem 0;
    font-size: 0.95rem;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: rgba(255, 255, 255, 0.84);
}

.wa-lede {
    margin: 0;
    color: var(--wa-text-dim);
    line-height: 1.6;
    max-width: 70ch;
}

.wa-copy {
    margin: 0;
    color: rgba(255, 255, 255, 0.80);
    line-height: 1.6;
}

.wa-view__header {
    margin: 0.65rem 0;
}

.wa-grid {
    display: grid;
    gap: 0.9rem;
    margin: 0.65rem 0;
}

.wa-grid--2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
}

.wa-grid--3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
}

.wa-card {
    border-radius: var(--wa-radius-md);
    border: 1px solid rgba(255, 255, 255, 0.14);
    padding: 0.95rem 1rem;
    margin: 0.65rem 0;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.35);
}

.wa-grid .wa-card {
    margin-top: 0;
    margin-bottom: 0;
}

.wa-card--glass {
    background: transparent;
}

@supports ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
    .wa-card--glass {
        backdrop-filter: blur(12px) saturate(1.2);
        -webkit-backdrop-filter: blur(12px) saturate(1.2);
    }
}

.wa-card--link {
    display: block;
    transition: transform 0.12s ease, border-color 0.12s ease;
}

.wa-card--link:hover {
    transform: translateY(-1px);
    border-color: rgba(255, 255, 255, 0.22);
}

.wa-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin-top: 0.85rem;
}

.wa-btn {
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.18);
    background: transparent;
    padding: 0.55rem 0.9rem;
    cursor: pointer;
    color: rgba(255, 255, 255, 0.9);
}

.wa-btn:disabled {
    cursor: not-allowed;
    opacity: 0.55;
}

.wa-btn--primary {
    border-color: rgba(255, 255, 255, 0.28);
}

.wa-btn:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.9);
    outline-offset: 2px;
}

.wa-note {
    margin-top: 0.85rem;
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.72);
}

.wa-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: 0.55rem;
}

.wa-listitem {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    width: 100%;
    text-align: left;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.14);
    background: transparent;
    padding: 0.7rem 0.85rem;
    cursor: pointer;
}

.wa-listitem:hover {
    border-color: rgba(255, 255, 255, 0.22);
}

.wa-listitem__title {
    font-weight: 600;
    color: rgba(255, 255, 255, 0.92);
}

.wa-listitem__meta {
    color: rgba(255, 255, 255, 0.66);
    font-size: 0.9rem;
}

/* Landing (fullscreen sign-in) */
.wa-landing {
    min-height: calc(100vh - 2.5rem);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1.6rem;
    padding: 2rem 1rem;
}

.wa-landing__brand {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.wa-landing__logo {
    width: 86px;
    height: 86px;
    border-radius: 22px;
    border: 2px solid rgba(255, 165, 0, 0.55);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 18px 50px rgba(0, 0, 0, 0.55);
}

.wa-landing__logo-mark {
    font-size: 2.2rem;
}

.wa-landing__name {
    font-size: clamp(2.1rem, 5vw, 3rem);
    font-weight: 700;
    letter-spacing: 0.02em;
}

.wa-landing__signin {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.9rem;
}

.wa-landing__signin-label {
    font-size: 0.95rem;
    letter-spacing: 0.28em;
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.78);
}

.wa-landing__spotify {
    border: none;
    border-radius: 999px;
    padding: 0.85rem 1.35rem;
    background: #1db954;
    color: white;
    font-weight: 700;
    font-size: 1.05rem;
    cursor: pointer;
    min-width: 190px;
}

.wa-landing__spotify:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.9);
    outline-offset: 3px;
}

.wa-landing__status {
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.66);
}

/* Bottom player bar (sticky, responsive controls) */
.wa-playerbar {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 9999;
    padding: 0.65rem 1.1rem;
    padding-bottom: calc(0.65rem + env(safe-area-inset-bottom, 0px));
    border-top: 1px solid rgba(255, 255, 255, 0.12);
    background: transparent;
}

@supports ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
    .wa-playerbar {
        backdrop-filter: blur(14px) saturate(1.2);
        -webkit-backdrop-filter: blur(14px) saturate(1.2);
    }
}

.wa-playerbar__inner {
    max-width: none;
    margin: 0 auto;
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    align-items: center;
    gap: 0.75rem;
}

.wa-playerbar__media {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    min-width: 0;
}

.wa-playerbar__art {
    width: 44px;
    height: 44px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.14);
    overflow: hidden;
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wa-playerbar__art-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: none;
}

.wa-playerbar__meta {
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
}

.wa-playerbar__title {
    font-weight: 600;
    color: rgba(255, 255, 255, 0.94);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.wa-playerbar__artist {
    color: rgba(255, 255, 255, 0.68);
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.wa-playerbar__controls {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
}

.wa-playerbar__btn {
    width: 42px;
    height: 42px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.16);
    background: transparent;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.wa-playerbar__btn:hover {
    border-color: rgba(255, 255, 255, 0.24);
}

.wa-playerbar__btn:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.9);
    outline-offset: 2px;
}

/* Mobile defaults: hide prev + scrubber */
.wa-playerbar__btn--prev {
    display: none;
}

.wa-playerbar__scrub {
    display: none;
}

@media (min-width: 900px) {
    :root {
        --wa-playerbar-height: 64px; /* was 86px */
    }

    .wa-playerbar__inner {
        /* Align to the desktop layout: sidebar column + content column */
        grid-template-columns: 260px auto minmax(240px, 1fr);
    }

    .wa-playerbar__btn--prev {
        display: inline-flex;
    }

    .wa-playerbar__scrub {
        display: flex;
        align-items: center;
        gap: 0.6rem;
    }

    .wa-playerbar__time {
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.66);
        min-width: 44px;
        text-align: center;
    }

    .wa-playerbar__range {
        width: 100%;
        accent-color: rgba(255, 255, 255, 0.9);
    }
}

@media (max-width: 820px) {
    .wa-layout {
        display: block;
        min-height: auto;
    }

    .wa-topbar__burger {
        display: inline-flex;
    }

    .wa-sidebar {
        position: fixed;
        top: 0;
        left: -102%;
        bottom: 0;
        width: min(84vw, 320px);
        z-index: 10001;
        border-radius: 0;
        transform: none;
        transition: left 0.18s ease;
        /* On mobile the sidebar overlays content; make it much harder to read through. */
        background: rgba(0, 0, 0, 0.78);
        height: auto;
        max-height: none;
    }

    .wa-sidebar__close {
        display: inline-flex;
    }

    .wa-sidebar-overlay {
        position: fixed;
        inset: 0;
        z-index: 10000;
        background: rgba(0, 0, 0, 0.55);
        display: block;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.18s ease;
    }

    [data-wa-sidebar-open="true"] .wa-sidebar {
        left: 0;
    }

    [data-wa-sidebar-open="true"] .wa-sidebar-overlay {
        opacity: 1;
        pointer-events: auto;
    }

    @supports ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
        .wa-sidebar {
            backdrop-filter: blur(20px) saturate(1.2) brightness(0.82);
            -webkit-backdrop-filter: blur(20px) saturate(1.2) brightness(0.82);
        }
    }

    .wa-grid--2 {
        grid-template-columns: 1fr;
    }

    .wa-grid--3 {
        grid-template-columns: 1fr;
    }
}

/* Landing should be fullscreen and hide navigation/player chrome */
.wa-app[data-wa-view="landing"] {
    padding-bottom: 1.25rem;
    max-width: none;
}

.wa-app[data-wa-view="landing"] .glass-surface {
    border: none;
    box-shadow: none;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

.wa-app[data-wa-view="landing"] .glass-surface__content {
    padding: 0;
}

.wa-app[data-wa-view="landing"] .wa-sidebar,
.wa-app[data-wa-view="landing"] .wa-topbar,
.wa-app[data-wa-view="landing"] .wa-playerbar,
.wa-app[data-wa-view="landing"] .wa-sidebar-overlay {
    display: none !important;
}

.wa-app[data-wa-view="landing"] .wa-layout {
    grid-template-columns: 1fr;
    min-height: calc(100vh - 2.5rem);
}
